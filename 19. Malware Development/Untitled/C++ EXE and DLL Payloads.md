# Using GCC 

To compile custom `.dll` and `.exe` files on Kali Linux using GCC, you'll need to use the MinGW (Minimalist GNU for Windows) compiler. MinGW allows you to cross-compile Windows binaries (like `.exe` and `.dll`) on Linux.

Hereâ€™s how you can set it up and compile both `.dll` and `.exe` files:

# Step 1: Install MinGW on Kali Linux

1. Open a terminal and update your package lists:

   ```bash
   sudo apt update
   ```

2. Install MinGW for both 32-bit and 64-bit cross-compilation:

   ```bash
   sudo apt install mingw-w64
   ```

This installs the MinGW compiler that you can use to create Windows executables and DLLs from Linux.

# Step 2: Compile a Custom `.exe` File

#### Example C++ Code for an `.exe`:

Here's a basic example of a simple `main.cpp` that prints a message to the console.

```cpp
#include <iostream>

int main() {
    std::cout << "Hello from Windows executable!" << std::endl;
    return 0;
}
```

#### Compile the `.exe`:

1. To compile this code into a 64-bit Windows executable (`.exe`), use the following `x86_64-w64-mingw32-g++` command:

   ```bash
   x86_64-w64-mingw32-g++ -o hello.exe main.cpp
   ```

2. If you want to compile it as a 32-bit executable, use the `i686-w64-mingw32-g++` command:

   ```bash
   i686-w64-mingw32-g++ -o hello32.exe main.cpp
   ```

Now, you'll have `hello.exe` or `hello32.exe`, which can be run on Windows.

# Step 3: Compile a Custom `.dll` File

#### Example C++ Code for a `.dll`:

Here's an example of how to define a simple Windows DLL that exports a function:

```cpp
// mydll.cpp
#include <windows.h>

extern "C" __declspec(dllexport) void MyFunction() {
    MessageBox(0, "Hello from DLL!", "DLL Message", MB_OK);
}

BOOL APIENTRY DllMain(HMODULE hModule, DWORD  ul_reason_for_call, LPVOID lpReserved) {
    switch (ul_reason_for_call) {
        case DLL_PROCESS_ATTACH:
        case DLL_THREAD_ATTACH:
        case DLL_THREAD_DETACH:
        case DLL_PROCESS_DETACH:
            break;
    }
    return TRUE;
}
```

#### Compile the `.dll`:

1. To compile this code into a 64-bit Windows DLL, use:

   ```bash
   x86_64-w64-mingw32-g++ -shared -o mydll.dll mydll.cpp -Wl,--out-implib,libmydll.a
   ```

   - `-shared`: This flag tells GCC to generate a DLL.
   - `-Wl,--out-implib,libmydll.a`: This flag generates an import library that you can link against if needed.

2. For a 32-bit DLL, use the 32-bit MinGW compiler:

   ```bash
   i686-w64-mingw32-g++ -shared -o mydll32.dll mydll.cpp -Wl,--out-implib,libmydll32.a
   ```

This will generate `mydll.dll` or `mydll32.dll` for Windows.

# Step 4: Test Your DLL or EXE on Windows

- You can transfer the compiled `.exe` or `.dll` file to a Windows machine using `scp`, USB, or any other file transfer method.
- Run the `.exe` by simply double-clicking it.
- To test the DLL, you can use a custom executable (like the one we previously wrote to load DLLs) or `rundll32.exe`.

# Summary of GCC MinGW Commands:

- Compile 64-bit `.exe`:
  ```bash
  x86_64-w64-mingw32-g++ -o <output_name>.exe <source_file>.cpp
  ```

- Compile 32-bit `.exe`:
  ```bash
  i686-w64-mingw32-g++ -o <output_name>.exe <source_file>.cpp
  ```

- Compile 64-bit `.dll`:
  ```bash
  x86_64-w64-mingw32-g++ -shared -o <output_name>.dll <source_file>.cpp -Wl,--out-implib,lib<output_name>.a
  ```

- Compile 32-bit `.dll`:
  ```bash
  i686-w64-mingw32-g++ -shared -o <output_name>.dll <source_file>.cpp -Wl,--out-implib,lib<output_name>.a
  ```

By following these steps, you can easily compile both `.exe` and `.dll` files on Kali Linux using GCC with the MinGW cross-compiler.
