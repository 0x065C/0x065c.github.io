# Index
- [[Front End Vulnerabilities]]
	- [[1. Sensitive Data Exposure]]
	- [[2. HTML Injection]]
	- [[3. Insecure Direct Object References (IDOR)]]
	- [[4. Cross-Site Scripting (XSS)]]
	- [[5. Cross-Site Request Forgery (CSRF)]]
	- [[6. Insufficient Transport Layer Protection]]
	- [[7. Insecure Handling of Cookies and Sessions]]
	- [[8. Security Misconfigurations|8. Security Misconfigurations]]

# Sensitive Data Exposure

Sensitive Data Exposure occurs when an application inadvertently discloses sensitive information such as personally identifiable information (PII), authentication credentials, financial data, or health records to unauthorized users. This can happen due to improper storage, transmission, or handling of sensitive data, making it accessible to attackers. Sensitive data exposure can lead to severe consequences such as identity theft, financial fraud, or further exploitation of users.

# How Sensitive Data Exposure Works

1. **Improper Storage:** Sensitive information is stored insecurely, such as unencrypted databases or plaintext log files, making it easily accessible if compromised.
2. **Insecure Transmission:** Data transmitted over insecure channels (e.g., HTTP instead of HTTPS) can be intercepted by attackers, allowing them to steal sensitive information such as login credentials or payment information.
3. **Exposure through APIs or Web Pages:** Sensitive information is sometimes exposed in API responses, URL parameters, or HTML source code, inadvertently leaking sensitive data to attackers.
4. **Error Handling and Debugging:** Improper error handling may expose sensitive details in error messages, such as database queries, usernames, or file paths.

## Example of Sensitive Data Exposure

Let’s consider a scenario where sensitive data is exposed through an insecure API:

1. **API Call:** The application makes a request to an API endpoint to retrieve user details.
   
```http
GET /api/user?user_id=123 HTTP/1.1
Host: api.example.com
```

2. **Insecure Response:** The server responds with detailed user information, including sensitive data such as the user's password hash and payment details, which are unnecessarily exposed:

```json
{
"user_id": 123,
"name": "John Doe",
"email": "john.doe@example.com",
"password_hash": "abc123hash",
"credit_card_number": "4111111111111111",
"cvv": "123"
   }
```

An attacker can intercept or access this API response, exposing sensitive data like the user’s email, password hash, and credit card details.

# Types of Sensitive Data Exposure

## Plaintext Password Storage
   - Storing user passwords as plaintext instead of securely hashing and salting them allows attackers to steal and use the passwords if the database is compromised.

## Insecure Communication (e.g., HTTP instead of HTTPS)
   - Transmitting sensitive information like login credentials, payment information, or personal data over an unencrypted connection (HTTP) makes it vulnerable to interception.

## Unnecessary Data Exposure in Responses
   - Including sensitive data in API responses or web pages, such as password hashes, PII, or payment information, unnecessarily exposes this data to attackers who might exploit it.

## Sensitive Information in URL Parameters
   - Sensitive data, such as session tokens or personal information, is sometimes passed in URL parameters, which can be logged in web server logs or accessed via browser history.

# Manual Discovery Techniques for Sensitive Data Exposure

To manually discover sensitive data exposure vulnerabilities, testers can inspect storage mechanisms, analyze communication channels, and review API responses or web pages to identify any unnecessary exposure of sensitive information.

## Inspect API Responses for Sensitive Data

Carefully review the responses returned from API endpoints to ensure they don’t leak sensitive data such as password hashes, credit card numbers, or user tokens.

### Example
- An API request to fetch user data may return unnecessary sensitive information:

```http
GET /api/user/profile?user_id=123 HTTP/1.1
Host: api.example.com
```

- If the response contains sensitive data like password hashes, API keys, or payment details, it indicates a vulnerability:

```json
{
"user_id": 123,
"username": "john_doe",
"email": "john.doe@example.com",
"password_hash": "abc123hash",
"api_key": "secret_api_key",
"credit_card": "4111111111111111"
}
```

## Check for Plaintext Password Storage

Examine how user passwords are stored in the database or application storage. Plaintext storage or weak encryption mechanisms like MD5 expose user credentials if the database is compromised.

### Example
```sql
SELECT * FROM users WHERE username = 'john_doe';

+-----------+------------------+---------------+
| user_id   | username          | password      |
+-----------+------------------+---------------+
| 123       | john_doe          | mypassword123 |
+-----------+------------------+---------------+
```

Storing passwords in plaintext is a critical vulnerability. Passwords should be hashed using strong algorithms such as bcrypt, PBKDF2, or Argon2.

## Analyze URL Parameters for Sensitive Data

Examine URL parameters to ensure sensitive information like session tokens, PII, or payment information is not passed through GET requests or included in URLs.

### Example
```html
http://example.com/account?user_id=123&session_token=abc123
```

Exposing sensitive data like session tokens in URLs can lead to session hijacking if the URL is logged or shared.

## Check for Insecure Data Transmission

Analyze whether sensitive data is transmitted over insecure communication channels (HTTP instead of HTTPS). Any sensitive information transmitted over HTTP is vulnerable to interception.

### Example
```http
POST http://example.com/login
Host: example.com
Content-Type: application/x-www-form-urlencoded

username=john_doe&password=mypassword123
```

Since the data is sent over an unencrypted HTTP connection, an attacker monitoring the traffic could intercept the login credentials.

## Look for Sensitive Data in Error Messages

Review the error handling mechanisms to see if detailed error messages expose sensitive information like database queries, internal file paths, or user data.

### Example
```plaintext
Error: SQL query failed:
SELECT * FROM users WHERE username = 'john_doe';
Database error: user not found
```

Exposing sensitive information about the database schema or internal logic provides valuable information to attackers.

# Resources

|**Website**|**URL**|
|-|-|
| OWASP - Sensitive Data Exposure                                 | https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure                                                                                                       |
| NIST - Protecting Controlled Unclassified Information (CUI)     | [https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final](https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final)                                             |
| GitHub - PayloadAllTheThings - Sensitive Data Exposure Payloads | [https://github.com/0x065C/PayloadsAllTheThings/tree/master/Sensitive%20Data%20Exposure](https://github.com/0x065C/PayloadsAllTheThings/tree/master/Sensitive%20Data%20Exposure) |
| Veracode - Secure Coding Best Practices                         | https://www.veracode.com/security/secure-coding-best-practices                                                                                                                   |
| SANS - Encryption and Data Protection                           | https://www.sans.org/white-papers/37915/                                                                                                                                         |