# Index
- [[Front End Vulnerabilities]]
	- [[1. Sensitive Data Exposure]]
	- [[2. HTML Injection]]
	- [[3. Insecure Direct Object References (IDOR)]]
	- [[4. Cross-Site Scripting (XSS)]]
	- [[5. Cross-Site Request Forgery (CSRF)]]
	- [[6. Insufficient Transport Layer Protection]]
	- [[7. Insecure Handling of Cookies and Sessions]]
	- [[8. Security Misconfigurations|8. Security Misconfigurations]]

# Insufficient Transport Layer Protection

Insufficient Transport Layer Protection refers to the failure to adequately secure the transmission of sensitive data over the network. When sensitive information such as login credentials, personal data, or payment information is transmitted without strong encryption or over insecure channels like HTTP, it is susceptible to interception and exploitation by attackers. Proper use of secure transport mechanisms like HTTPS, TLS, and correct configurations are critical to protect data in transit.

# How Insufficient Transport Layer Protection Works

1. **Insecure Communication Channel (HTTP):** When data is sent over HTTP, it is transmitted in plaintext, which can be intercepted by attackers using tools like packet sniffers.
2. **Weak or Misconfigured SSL/TLS:** Even when HTTPS is used, weak or misconfigured SSL/TLS implementations (e.g., using outdated protocols like TLS 1.0) can still expose sensitive data to interception or attacks like man-in-the-middle (MITM).
3. **Unencrypted Sensitive Data:** Applications that fail to encrypt sensitive data (e.g., login credentials, API keys) before transmission over the network leave it vulnerable to being stolen or tampered with.

## Example of Insufficient Transport Layer Protection

Let’s examine a scenario where sensitive data is transmitted over an insecure connection:

1. **Login Request:**
   A user submits their login credentials on a website that is not using HTTPS:

```http
POST /login HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded

username=john_doe&password=secret_password123
```

2. **Plaintext Transmission:**
   Since the site uses HTTP, the login credentials are transmitted in plaintext. An attacker intercepting the network traffic can easily capture the credentials:

```plaintext
username=john_doe
password=secret_password123
```

This lack of encryption allows an attacker to gain access to the victim’s account and potentially other sensitive data.

# Types of Insufficient Transport Layer Protection

## Use of HTTP Instead of HTTPS
   - Transmitting sensitive data over HTTP sends it in plaintext, making it vulnerable to interception by attackers using man-in-the-middle (MITM) attacks or packet sniffing.

## Weak SSL/TLS Configurations
   - Using outdated or insecure protocols (e.g., SSL, TLS 1.0) or weak cipher suites can lead to vulnerabilities, allowing attackers to decrypt or manipulate data in transit.

## Mixed Content (HTTPS and HTTP)
   - Serving some resources over HTTP on an HTTPS website (e.g., images, scripts) can lead to MITM attacks, as attackers can inject malicious content into the unprotected resources.

## Expired or Invalid Certificates
   - Using expired, self-signed, or improperly configured certificates can compromise the security of HTTPS, leading to warnings in browsers and making the site susceptible to MITM attacks.

# Manual Discovery Techniques for Insufficient Transport Layer Protection

To manually discover Insufficient Transport Layer Protection vulnerabilities, testers should analyze the communication channels used by the application, inspect SSL/TLS configurations, and verify that all sensitive data is transmitted securely.

## Analyze Network Traffic for Insecure Transmission

Use tools like **Wireshark** or **Burp Suite** to capture and analyze network traffic. Look for sensitive data such as login credentials, API keys, or personal information being transmitted over unencrypted HTTP.

### Example
- Capture a login request sent over HTTP:

```http
POST /login HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded

username=john_doe&password=secret_password123
```

- If the credentials are transmitted in plaintext, it indicates insufficient transport layer protection.

## Inspect SSL/TLS Configuration

Use tools like **SSL Labs** or **OpenSSL** to check for weak or misconfigured SSL/TLS implementations. Verify the use of strong encryption protocols, valid certificates, and secure cipher suites.

### Example
- Run an **SSL Labs** scan on a target domain to identify issues with the SSL/TLS configuration.
  
```bash
openssl s_client -connect <target_domain>:443
```

- Check for:
  - Use of outdated protocols (e.g., SSL, TLS 1.0, TLS 1.1).
  - Weak cipher suites (e.g., RC4).
  - Expired or self-signed certificates.

## Check for Mixed Content

Inspect a web application that serves resources (images, scripts, styles) over HTTP on an HTTPS page. Mixed content weakens the security of the HTTPS connection by allowing attackers to inject malicious content.

### Example
- Use **browser developer tools** to inspect network requests and look for resources served over HTTP:

```plaintext
http://example.com/script.js
```

- If resources are loaded over HTTP on an HTTPS page, it indicates a mixed content vulnerability.

## Test for Expired or Invalid Certificates

Verify the SSL certificates used by the target domain to ensure they are valid, not expired, and issued by a trusted certificate authority (CA).

### Example
- Use browser tools or run an **OpenSSL** command to check the certificate validity:

```bash
openssl s_client -connect <target_domain>:443
```

- Check for certificate expiration dates or self-signed certificates:

```plaintext
Verify return code: 10 (certificate has expired)
```

## Inspect Application Logs for Sensitive Data

Check if sensitive data, such as session tokens or API keys, is logged in plaintext in the application logs during network transmission. 

### Example
- Review server logs to identify if session tokens or sensitive user information is logged during an HTTP request:

```plaintext
[INFO] Received request: POST /login - username=john_doe, password=secret_password123
```

# Resources

| **Website** | **URL** |
|-------------|---------|
| OWASP - Transport Layer Protection Cheat Sheet | [https://owasp.org/www-project-cheat-sheets/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html](https://owasp.org/www-project-cheat-sheets/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html) |
| SSL Labs - SSL Test | [https://www.ssllabs.com/ssltest/](https://www.ssllabs.com/ssltest/) |
| Veracode - Transport Layer Security | [https://www.veracode.com/security/transport-layer-security](https://www.veracode.com/security/transport-layer-security) | 
| GitHub - PayloadAllTheThings | [https://github.com/0x065C/PayloadsAllTheThings](https://github.com/0x065C/PayloadsAllTheThings) |