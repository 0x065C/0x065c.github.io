# Index
- [[Front End Vulnerabilities]]
    - [[1. Sensitive Data Exposure]]
    - [[2. HTML Injection]]
    - [[3. Insecure Direct Object References (IDOR)]]
    - [[4. Cross-Site Scripting (XSS)]]
    - [[5. Cross-Site Request Forgery (CSRF)]]
    - [[6. Insufficient Transport Layer Protection]]
    - [[7. Insecure Handling of Cookies and Sessions]]
    - [[8. Security Misconfigurations|8. Security Misconfigurations]]

# Insecure Direct Object References (IDOR)

Insecure Direct Object References (IDOR) occur when an application exposes a reference to an internal object (such as a file, database entry, or resource) without enforcing sufficient access control. This allows attackers to manipulate object references, such as modifying parameters in a URL or API call, to access unauthorized data. IDOR is often a result of improper access controls or insufficient authorization checks.

# How IDOR Works

IDOR vulnerabilities arise when user input, like an object identifier (ID), is directly passed to access internal resources without proper validation. If the application does not check whether the user has permission to access or modify the resource, attackers can change the identifier in the request to access or alter data they are not authorized to view or manipulate.

## Example of Vulnerable Code

Imagine a URL that allows users to access their profile:

```
http://<target_domain>/user/profile?id=12345
```

Here, `12345` is the ID of the user's profile in the database. If the application does not verify that the user is authorized to access that profile, an attacker could change the ID to another user's ID, such as:

```
http://<target_domain>/user/profile?id=12346
```

If no authorization checks are in place, the attacker may now access another user's profile data.

## Example of IDOR in API Endpoints

APIs that return resources based on object IDs are also common vectors for IDOR attacks. For example, consider the following API call:

```
GET /api/user/order/98765
```

If an attacker modifies the order ID, such as:

```
GET /api/user/order/98766
```

and the application does not enforce proper access control, the attacker might access another user's order details.

# Manual Discovery Techniques for IDOR

To manually discover IDOR vulnerabilities, testers need to systematically alter object references like IDs, file names, or other parameters that map to sensitive resources. Below are step-by-step techniques to identify IDOR vulnerabilities.

## Identify Object References

First, identify object references that are included in URLs, form fields, or API endpoints. Common object references include:
- User IDs
- File names or paths
- Order numbers
- Database record IDs

For example:
```
http://<target_domain>/user/profile?id=12345
```

## Modify Object References

Modify the object reference and observe whether the application allows unauthorized access to other resources. Try changing the ID or resource identifier in the URL, API call, or form field to see if you can access another user's data.

## Example

Original URL:
```
http://<target_domain>/user/profile?id=12345
```

Modified URL:
```
http://<target_domain>/user/profile?id=12346
```

If you can access another user's profile without authentication, this indicates an IDOR vulnerability.

## Check API Calls for IDOR

Use tools like **Burp Suite** or **OWASP ZAP** to intercept and modify API requests that include object references. Modify the object IDs in the request and check if you can access or modify data without authorization.

Example API request:
```
GET /api/user/files/87654
```

Modify the file ID:
```
GET /api/user/files/87655
```

If you can access another user's file without proper permission, this indicates a vulnerability.

## Test for Different Object Types

IDOR vulnerabilities can occur in various object types, not just user accounts. Test modifying IDs or references related to:
- **Files:** Access or manipulate unauthorized files.
- **Records:** Access or alter sensitive records in a database.
- **Actions:** Perform unauthorized actions, such as canceling another user's order.

Example:
```
POST /api/order/cancel?order_id=87654
```

Modify the `order_id`:
```
POST /api/order/cancel?order_id=87655
```

If you can cancel another user's order, the application is vulnerable to IDOR.

## Use Interception Tools

Interception tools like **Burp Suite** can automate the process of testing IDOR by allowing you to systematically modify object references and replay requests. Use these tools to:
- Modify URL parameters
- Manipulate API request bodies
- Test for access to unauthorized resources

## Use Access-Control Testing Tools

Tools such as **Access Control Matrix Testing Tools** can help map out object references and user roles to identify potential access control issues. These tools can automate the process of testing various object references across different user roles.

# IDOR Exploitation Techniques

Once an IDOR vulnerability is identified, attackers can exploit it to:
- **Access Sensitive Data:** View other users' personal information, financial records, or sensitive files.
- **Modify Data:** Change another user's information, such as altering their profile details or manipulating records.
- **Delete Data:** Delete or modify files, orders, or other objects they should not have access to.

## Example Exploitation Payloads

- **URL Parameter Modification:** Modify the object ID in a URL parameter to access another user's data.
   
   Original:
   ```
   http://<target_domain>/user/profile?id=1001
   ```
   Exploit:
   ```
   http://<target_domain>/user/profile?id=1002
   ```

- **API Call Manipulation:** Change object IDs in API calls to view or modify unauthorized data.
   
   Original request:
   ```
   GET /api/user/order/5678
   ```
   Exploit:
   ```
   GET /api/user/order/5679
   ```

- **File Download Exploit:** Manipulate file references to download files belonging to other users.
   
   Original:
   ```
   http://<target_domain>/download?file_id=123
   ```
   Exploit:
   ```
   http://<target_domain>/download?file_id=124
   ```

- **Record Deletion Exploit:** Modify object IDs in a delete request to remove another user's data.
   
   Original request:
   ```
   DELETE /api/records/5678
   ```
   Exploit:
   ```
   DELETE /api/records/5679
   ```

# Bypassing Defenses

To bypass defenses and exploit IDOR vulnerabilities, attackers may use the following techniques:

## User Role Manipulation
   - If the application partially enforces access control by checking roles, attackers may attempt to escalate privileges by manipulating user roles or session tokens to gain unauthorized access.

## Brute Force Object IDs
   - Attackers can brute force object IDs by iterating over a range of object references. If IDs are predictable or sequential, this can allow access to multiple resources.

   Example:
   ```
   http://<target_domain>/user/profile?id=1001
   http://<target_domain>/user/profile?id=1002
   http://<target_domain>/user/profile?id=1003
   ```

## Use of Authentication Tokens
   - Attackers may attempt to capture or manipulate session tokens associated with object references to access unauthorized resources.

# Resources

|**Website**|**URL**|
|-|-|
| GitHub - PayloadAllTheThings - Insecure Direct Object References | [https://github.com/0x065C/PayloadsAllTheThings/tree/master/Insecure%20Direct%20Object%20References](https://github.com/0x065C/PayloadsAllTheThings/tree/master/Insecure%20Direct%20Object%20References) |
| OWASP - Insecure Direct Object Reference                         | https://owasp.org/www-community/attacks/Insecure_Direct_Object_Reference                                                                                                                                 |
| OWASP - Access Control Cheat Sheet                               | https://cheatsheetseries.owasp.org/cheatsheets/Access_Control_Cheat_Sheet.html                                                                                                                           |
| Acunetix - Insecure Direct Object Reference Vulnerability (IDOR) | https://www.acunetix.com/blog/web-security-zone/what-is-insecure-direct-object-referenc                                                                                                                  |